!function(){"use strict";var n=self,e=n.WebSharper=n.WebSharper||{},t=e.Collections=e.Collections||{},f=t.BalancedTree=t.BalancedTree||{},u=f.Tree=f.Tree||{},r=t.Pair=t.Pair||{},i=t.MapUtil=t.MapUtil||{},o=e&&e.Obj,l=t.FSharpMap=t.FSharpMap||{},c=t.Map=t.Map||{},a=t.FSharpSet=t.FSharpSet||{},s=t.Set=t.Set||{},h=t.ListEnumerator=t.ListEnumerator||{},p=t.List=t.List||{},d=t.LinkedListEnumerator=t.LinkedListEnumerator||{},m=t.LinkedList=t.LinkedList||{},y=e.Grouping=e.Grouping||{},C=e.FsComparer=e.FsComparer||{},v=e.ProjectionComparer=e.ProjectionComparer||{},N=e.CompoundComparer=e.CompoundComparer||{},w=e.ReverseComparer=e.ReverseComparer||{},g=e.OrderedEnumerable=e.OrderedEnumerable||{},$=e.Linq=e.Linq||{},E=e.Query=e.Query||{},S=e&&e.Arrays,G=e&&e.Seq,q=e&&e.Unchecked,L=e&&e.List,R=n.IntelliFactory,B=R&&R.Runtime,M=e&&e.Enumerator,T=e&&e.Operators,_=t&&t.HashSet,F=t&&t.Dictionary,b=e&&e.Nullable,O=e&&e.Option;u.New=function(n,e,t,r,u){return{Node:n,Left:e,Right:t,Height:r,Count:u}},f.TryFind=function(n,e){e=f.Lookup(n,e)[0];return null==e?null:{$:1,$0:e.Node}},f.Contains=function(n,e){return!(null==f.Lookup(n,e)[0])},f.Add=function(n,e){return f.Put(function(n,e){return e},n,e)},f.Remove=function(n,e){var t=f.Lookup(n,e),n=t[0],t=t[1];return null==n?e:null==n.Right?f.Rebuild(t,n.Left):null==n.Left?f.Rebuild(t,n.Right):f.Rebuild(t,(n=S.ofSeq(G.append(f.Enumerate(!1,n.Left),f.Enumerate(!1,n.Right))),f.Build(n,0,n.length-1)))},f.Put=function(n,e,t){var r=f.Lookup(e,t),t=r[0];return null==t?f.Rebuild(r[1],f.Branch(e,null,null)):f.Rebuild(r[1],f.Branch(n(t.Node,e),t.Left,t.Right))},f.Rebuild=function(n,e){var t,r,u,i,o,l,c;function a(n){return null==n?0:n.Height}for(t=e,r=0,u=S.length(n)-1;r<=u;r++)t=(c=S.get(n,r))[0]?(o=c[1],l=c[2],a(t)>a(l)+1?a(t.Left)===a(t.Right)+1?(i=t.Left,f.Branch(i.Node,f.Branch(o,l,i.Left),f.Branch(t.Node,i.Right,t.Right))):f.Branch(t.Node,f.Branch(o,l,t.Left),t.Right):f.Branch(o,l,t)):(o=c[1],l=c[2],a(t)>a(l)+1?a(t.Right)===a(t.Left)+1?(c=t.Right,f.Branch(c.Node,f.Branch(t.Node,t.Left,c.Left),f.Branch(o,c.Right,l))):f.Branch(t.Node,t.Left,f.Branch(o,t.Right,l)):f.Branch(o,t,l));return t},f.Lookup=function(n,e){for(var t,r=[],u=e,i=!0;i;)null==u||0===(t=q.Compare(n,u.Node))?i=!1:u=1===t?(r.unshift([!0,u.Node,u.Left]),u.Right):(r.unshift([!1,u.Node,u.Right]),u.Left);return[u,r]},f.OfSeq=function(n){n=S.ofSeq(G.distinct(n));return S.sortInPlace(n),f.Build(n,0,n.length-1)},f.Build=function(n,e,t){var r;return t-e+1<=0?null:(e=f.Build(n,e,(r=(e+t)/2>>0)-1),t=f.Build(n,1+r,t),f.Branch(S.get(n,r),e,t))},f.Enumerate=function(r,n){return G.unfold(function(n){return function(n,e){for(var t;;){if(null==n)return 1==e.$?{$:1,$0:[e.$0[0],[e.$0[1],e.$1]]}:null;e=r?(n=(t=n).Right,new L.T({$:1,$0:[t.Node,t.Left],$1:e})):(n=(t=n).Left,new L.T({$:1,$0:[t.Node,t.Right],$1:e}))}}(n[0],n[1])},[n,L.T.Empty])},f.Branch=function(n,e,t){var r;return u.New(n,e,t,1+(r=null==e?0:e.Height,n=null==t?0:t.Height,1===q.Compare(r,n)?r:n),1+(null==e?0:e.Count)+(null==t?0:t.Count))},(r=t.Pair=B.Class({Equals:function(n){return q.Equals(this.Key,n.Key)},GetHashCode:function(){return q.Hash(this.Key)},CompareTo0:function(n){return q.Compare(this.Key,n.Key)}},null,r)).New=function(n,e){return new r({Key:n,Value:e})},i.fromSeq=function(n){var e=S.ofSeq(G.delay(function(){return G.collect(function(n){return[r.New(n[0],n[1])]},G.distinctBy(function(n){return n[0]},n))}));return S.sortInPlace(e),f.Build(e,0,e.length-1)},(l=t.FSharpMap=B.Class({Equals:function(n){return this.get_Count()===n.get_Count()&&G.forall2(q.Equals,this,n)},GetHashCode:function(){return q.Hash(S.ofSeq(this))},GetEnumerator$1:function(){return M.Get(G.map(function(n){return{K:n.Key,V:n.Value}},f.Enumerate(!1,this.tree)))},TryFind:function(n){n=f.TryFind(r.New(n,void 0),this.tree);return null==n?null:{$:1,$0:n.$0.Value}},Remove:function(n){return new l.New$1(f.Remove(r.New(n,void 0),this.tree))},get_Item:function(n){n=this.TryFind(n);return null==n?T.FailWith("The given key was not present in the dictionary."):n.$0},get_IsEmpty:function(){return null==this.tree},get_Count:function(){var n=this.tree;return null==n?0:n.Count},TryGetValue:function(n,e){n=this.TryFind(n);return null!=n&&1==n.$&&(e.set(n.$0),!0)},ContainsKey:function(n){return f.Contains(r.New(n,void 0),this.tree)},Add:function(n,e){return new l.New$1(f.Add(r.New(n,e),this.tree))},get_Tree:function(){return this.tree},GetEnumerator:function(){return this.GetEnumerator$1()},GetEnumerator0:function(){return this.GetEnumerator$1()},CompareTo0:function(n){return G.compareWith(q.Compare,this,n)}},o,l)).New=B.Ctor(function(n){l.New$1.call(this,i.fromSeq(n))},l),l.New$1=B.Ctor(function(n){o.New.call(this),this.tree=n},l),c.Map=function(e,n){return new l.New$1(f.OfSeq(G.map(function(n){return r.New(n.Key,e(n.Key,n.Value))},f.Enumerate(!1,n.get_Tree()))))},c.TryPick=function(e,n){return G.tryPick(function(n){return e(n.K,n.V)},n)},c.TryFindKey=function(e,n){return G.tryPick(function(n){return e(n.K,n.V)?{$:1,$0:n.K}:null},n)},c.TryFind=function(n,e){return e.TryFind(n)},c.ToSeq=function(n){return G.map(function(n){return[n.Key,n.Value]},f.Enumerate(!1,n.get_Tree()))},c.Pick=function(e,n){return G.pick(function(n){return e(n.K,n.V)},n)},c.Partition=function(e,n){var t=S.partition(function(n){return e(n.Key,n.Value)},S.ofSeq(f.Enumerate(!1,n.get_Tree())));return[new l.New$1((n=t[0],f.Build(n,0,n.length-1))),new l.New$1((t=t[1],f.Build(t,0,t.length-1)))]},c.OfArray=function(n){return new l.New$1(f.OfSeq(G.map(function(n){return r.New(n[0],n[1])},n)))},c.Iterate=function(e,n){G.iter(function(n){e(n.K,n.V)},n)},c.ForAll=function(e,n){return G.forall(function(n){return e(n.K,n.V)},n)},c.FoldBack=function(t,n,e){return G.fold(function(n,e){return t(e.Key,e.Value,n)},e,f.Enumerate(!0,n.get_Tree()))},c.Fold=function(t,n,e){return G.fold(function(n,e){return t(n,e.Key,e.Value)},n,f.Enumerate(!1,e.get_Tree()))},c.FindKey=function(e,n){return G.pick(function(n){return e(n.K,n.V)?{$:1,$0:n.K}:null},n)},c.Filter=function(e,n){return new l.New$1((n=S.ofSeq(G.filter(function(n){return e(n.Key,n.Value)},f.Enumerate(!1,n.get_Tree()))),f.Build(n,0,n.length-1)))},c.Exists=function(e,n){return G.exists(function(n){return e(n.K,n.V)},n)},(a=t.FSharpSet=B.Class({Equals:function(n){return this.get_Count()===n.get_Count()&&G.forall2(q.Equals,this,n)},GetHashCode:function(){return-1741749453+q.Hash(S.ofSeq(this))},GetEnumerator$1:function(){return M.Get(f.Enumerate(!1,this.tree))},Remove:function(n){return new a.New$1(f.Remove(n,this.tree))},get_MinimumElement:function(){return G.head(f.Enumerate(!1,this.tree))},get_MaximumElement:function(){return G.head(f.Enumerate(!0,this.tree))},IsSupersetOf:function(n){var e=this;return G.forall(function(n){return e.Contains(n)},n)},IsSubsetOf:function(e){return G.forall(function(n){return e.Contains(n)},this)},IsProperSupersetOf:function(n){return this.IsSupersetOf(n)&&this.get_Count()>n.get_Count()},IsProperSubsetOf:function(n){return this.IsSubsetOf(n)&&this.get_Count()<n.get_Count()},get_Tree:function(){return this.tree},get_IsEmpty:function(){return null==this.tree},get_Count:function(){var n=this.tree;return null==n?0:n.Count},Contains:function(n){return f.Contains(n,this.tree)},Add:function(n){return new a.New$1(f.Add(n,this.tree))},sub:function(e){return s.Filter(function(n){return!e.Contains(n)},this)},add:function(n){return new a.New$1(f.OfSeq(G.append(this,n)))},CompareTo0:function(n){return G.compareWith(q.Compare,this,n)},GetEnumerator:function(){return this.GetEnumerator$1()},GetEnumerator0:function(){return this.GetEnumerator$1()}},o,a)).op_Subtraction=function(n,e){return s.Filter(function(n){return!e.Contains(n)},n)},a.op_Addition=function(n,e){return new a.New$1(f.OfSeq(G.append(n,e)))},a.New=B.Ctor(function(n){a.New$1.call(this,f.OfSeq(n))},a),a.New$1=B.Ctor(function(n){o.New.call(this),this.tree=n},a),s.Partition=function(n,e){e=S.partition(n,S.ofSeq(e));return[new a.New$1(f.OfSeq(e[0])),new a.New$1(f.OfSeq(e[1]))]},s.FoldBack=function(t,n,e){return G.fold(function(n,e){return t(e,n)},e,f.Enumerate(!0,n.get_Tree()))},s.Filter=function(n,e){return new a.New$1((e=S.ofSeq(G.filter(n,e)),f.Build(e,0,e.length-1)))},(h=t.ListEnumerator=B.Class({get_Current:function(){return S.get(this.arr,this.i)},MoveNext$1:function(){return this.i=this.i+1,this.i<S.length(this.arr)},Dispose:n.ignore,Current:function(){return S.get(this.arr,this.i)},Reset:function(){T.FailWith("IEnumerator.Reset not supported")},Current0:function(){return S.get(this.arr,this.i)},MoveNext:function(){return this.MoveNext$1()}},o,h)).New=B.Ctor(function(n){o.New.call(this),this.arr=n,this.i=-1},h),(p=t.List=B.Class({GetEnumerator:function(){return M.Get(this)},GetEnumerator0:function(){return M.Get0(this)}},null,p)).RemoveAll=function(n,e){for(var t,r=0,u=0;u<S.length(n);)if(e(n[u])){for(t=u+1;t<S.length(n)&&e(n[t]);)t+=1;r=r+t-u,n.splice.apply(n,[u,t-u])}else u+=1;return r},p.Remove=function(n,e){var t=S.findIndexBound(n,0,S.length(n),null==e?function(n){return null==n}:function(n){return q.Equals(e,n)});return-1!==t&&(n.splice.apply(n,[t,1]),!0)},(d=t.LinkedListEnumerator=B.Class({Reset:n.ignore,Dispose:n.ignore,MoveNext:function(){return this.c=this.c.n,!q.Equals(this.c,null)},Current0:function(){return this.c.v},Current:function(){return this.c.v}},o,d)).New=B.Ctor(function(n){o.New.call(this),this.c=n},d),(m=t.LinkedList=B.Class({RemoveLast:function(){this.Remove$1(this.p)},RemoveFirst:function(){this.Remove$1(this.n)},Remove:function(n){n=this.Find(n);return!q.Equals(n,null)&&(this.Remove$1(n),!0)},Remove$1:function(n){var e=n.p,n=n.n;q.Equals(e,null)?this.n=n:e.n=n,q.Equals(n,null)?this.p=e:n.p=e,this.c=this.c-1},GetEnumerator$1:function(){return new d.New(this)},FindLast:function(n){for(var e=this.p,t=!0;t&&!q.Equals(e,null);)e.v==n?t=!1:e=e.p;return t?null:e},Find:function(n){for(var e=this.n,t=!0;t&&!q.Equals(e,null);)e.v==n?t=!1:e=e.n;return t?null:e},Contains:function(n){for(var e=!1,t=this.n;!q.Equals(t,null)&&!e;)t.v==n?e=!0:t=t.n;return e},Clear:function(){this.c=0,this.n=null,this.p=null},AddLast:function(n){var e;return 0===this.c?(this.n=e={p:null,n:null,v:n},this.p=this.n,this.c=1,e):this.AddAfter(this.p,n)},AddFirst:function(n){var e;return 0===this.c?(this.n=e={p:null,n:null,v:n},this.p=this.n,this.c=1,e):this.AddBefore(this.n,n)},AddBefore:function(n,e){var t=n.p,e={p:t,n:n,v:e};return q.Equals(n.p,null)&&(this.n=e),n.p=e,q.Equals(t,null)||(t.n=e),this.c=this.c+1,e},AddAfter:function(n,e){var t=n.n,e={p:n,n:t,v:e};return q.Equals(n.n,null)&&(this.p=e),n.n=e,q.Equals(t,null)||(t.p=e),this.c=this.c+1,e},GetEnumerator:function(){return this.GetEnumerator$1()},GetEnumerator0:function(){return this.GetEnumerator$1()}},o,m)).New=B.Ctor(function(){m.New$1.call(this,[])},m),m.New$1=B.Ctor(function(n){var e,t;for(o.New.call(this),this.c=0,this.n=null,this.p=null,(e=M.Get(n)).MoveNext()&&(this.n={p:null,n:null,v:e.Current()},this.p=this.n,this.c=1);e.MoveNext();)t={p:this.p,n:null,v:e.Current()},this.p.n=t,this.p=t,this.c=this.c+1},m),(y=e.Grouping=B.Class({System_Linq_IGrouping_2$get_Key:function(){return this.k},GetEnumerator0:function(){return M.Get0(this.v)},GetEnumerator:function(){return M.Get(this.v)}},o,y)).New=B.Ctor(function(n,e){o.New.call(this),this.k=n,this.v=e},y),(C=e.FsComparer=B.Class({Compare:function(n,e){return q.Compare(n,e)}},o,C)).New=B.Ctor(function(){o.New.call(this)},C),(v=e.ProjectionComparer=B.Class({Compare:function(n,e){return this.primary.Compare(this.projection(n),this.projection(e))}},o,v)).New=B.Ctor(function(n,e){o.New.call(this),this.primary=n,this.projection=e},v),(N=e.CompoundComparer=B.Class({Compare:function(n,e){var t=this.primary.Compare(n,e);return 0===t?this.secondary.Compare(n,e):t}},o,N)).New=B.Ctor(function(n,e){o.New.call(this),this.primary=n,this.secondary=e},N),(w=e.ReverseComparer=B.Class({Compare:function(n,e){return this.primary.Compare(this.projection(e),this.projection(n))}},o,w)).New=B.Ctor(function(n,e){o.New.call(this),this.primary=n,this.projection=e},w),(g=e.OrderedEnumerable=B.Class({GetEnumerator0:function(){return M.Get(this)},GetEnumerator:function(){var t=this,n=S.ofSeq(this.source);return S.sortInPlaceWith(function(n,e){return t.primary.Compare(n,e)},n),M.Get(n)},System_Linq_IOrderedEnumerable_1$CreateOrderedEnumerable:function(n,e,t){return new g.New(this.source,new N.New(this.primary,new(t?w:v).New(e,n)))}},o,g)).New=B.Ctor(function(n,e){o.New.call(this),this.source=n,this.primary=e},g),$.ElementAtOrDefault=function(n,e,t){try{return G.nth(e,n)}catch(n){return t}},$.FirstOrDefault=function(n,e){n=M.Get(n);try{return n.MoveNext()?n.Current():e}finally{"object"==typeof n&&"Dispose"in n&&n.Dispose()}},$.FirstOrDefault$1=function(n,e,t){n=G.tryFind(e,n);return null==n?t:n.$0},$.LastOrDefault=function(n,e,t){e=$.LastPred(n,e);return null==e?t:e.$0},$.SingleOrDefault=function(n,e,t){var r,u=M.Get(n);try{for(r=null;u.MoveNext();)e(u.Current())&&(null!=r&&1==r.$?T.InvalidOp("Sequence contains more than one element"):r={$:1,$0:u.Current()});return null==r?t:r.$0}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}},$.Where=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=0;return G.enumWhile(function(){return n.MoveNext()},G.delay(function(){return G.append(t(n.Current(),e)?[n.Current()]:[],G.delay(function(){return e+=1,[]}))}))})})},$.Union=function(n,e,t){var r=new _.New(n,t),u=M.Get(e);try{for(;u.MoveNext();)r.Add(u.Current())}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}return r},$.ToDictionary=function(n,e,t,r){var u=new F.New$3(r);return G.iter(function(n){u.Add(e(n),t(n))},n),u},$.ToDictionary$1=function(n,e,t){var r=new F.New$3(t);return G.iter(function(n){r.Add(e(n),n)},n),r},$.TakeWhile=function(n,e){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){return G.enumWhile(function(){return n.MoveNext()&&e(n.Current())},G.delay(function(){return[n.Current()]}))})})},$.TakeWhile$1=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=0;return G.enumWhile(function(){return n.MoveNext()&&t(n.Current(),e)},G.delay(function(){return e+=1,[n.Current()]}))})})},$.Take=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=0;return G.enumWhile(function(){return e<t&&n.MoveNext()},G.delay(function(){return e+=1,[n.Current()]}))})})},$.Sum=function(n){n=G.choose(function(n){return null!=n?{$:1,$0:b.get(n)}:null},n);return G.isEmpty(n)?null:G.sum(n)},$.SkipWhile=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=!0;return G.append(G.enumWhile(function(){return e&&n.MoveNext()},G.delay(function(){return t(n.Current())||(e=!1),[]})),G.delay(function(){return e?[]:G.append([n.Current()],G.delay(function(){return G.enumWhile(function(){return n.MoveNext()},G.delay(function(){return[n.Current()]}))}))}))})})},$.SkipWhile$1=function(n,r){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=0,t=!0;return G.append(G.enumWhile(function(){return t&&n.MoveNext()},G.delay(function(){return r(n.Current(),e)?e+=1:t=!1,[]})),G.delay(function(){return t?[]:G.append([n.Current()],G.delay(function(){return G.enumWhile(function(){return n.MoveNext()},G.delay(function(){return[n.Current()]}))}))}))})})},$.Skip=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=0;return G.append(G.enumWhile(function(){return e<t&&n.MoveNext()},G.delay(function(){return e+=1,[]})),G.delay(function(){return G.enumWhile(function(){return n.MoveNext()},G.delay(function(){return[n.Current()]}))}))})})},$.Single=function(n,t){return null!=(n=B.Curried3(G.fold)(function(n,e){return t(e)?null!=n?T.InvalidOp("Sequence contains more than one matching element"):{$:1,$0:e}:n})(null)(n))&&1==n.$?n.$0:T.InvalidOp("Sequence contains no elements")},$.SequenceEqual=function(n,e,t){var r,u,i=M.Get(n);try{u=M.Get(n);try{r=function(){for(;;){if(!i.MoveNext())return!u.MoveNext();if(!u.MoveNext()||!t.CEquals(i.Current(),u.Current()))return!1}}()}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}return r}finally{"object"==typeof i&&"Dispose"in i&&i.Dispose()}},$.SelectMany=function(n,t,r){return G.collect(function(n){return e=n[0],n=n[1],G.map(function(n){return r(e,n)},n);var e},G.mapi(function(n,e){return[e,t(e,n)]},n))},$.SelectMany$1=function(n,e,t){return G.collect(function(n){return e=n[0],n=n[1],G.map(function(n){return t(e,n)},n);var e},G.map(function(n){return[n,e(n)]},n))},$.SelectMany$2=function(n,t){return G.concat(G.mapi(function(n,e){return t(e,n)},n))},$.Select=function(n,t){return G.mapi(function(n,e){return t(e,n)},n)},$.Reverse=function(n){return S.ofSeq(n).slice().reverse()},$.Repeat=function(n,e){return G.init(e,function(){return n})},$.Range=function(e,n){return G.init(n,function(n){return e+n})},$.OrderByDescending=function(n,e,t){return new g.New(n,new w.New(t,e))},$.OrderBy=function(n,e,t){return new g.New(n,new v.New(t,e))},$.Min=function(n){n=G.choose(function(n){return null!=n?{$:1,$0:b.get(n)}:null},n);return G.isEmpty(n)?null:G.min(n)},$.Max=function(n){n=G.choose(function(n){return null!=n?{$:1,$0:b.get(n)}:null},n);return G.isEmpty(n)?null:G.max(n)},$.Last=function(n,e){e=$.LastPred(n,e);return null==e?T.InvalidOp("Sequence contains no matching element"):e.$0},$.LastPred=function(n,t){return B.Curried3(G.fold)(function(n,e){return t(e)?{$:1,$0:e}:n})(null)(n)},$.Join=function(e,t,i,o,l,c){return G.delay(function(){var r=new F.New$3(c),n=S.ofSeq(G.delay(function(){return G.collect(function(n){var e=i(n),t=null;return r.TryGetValue(e,{get:function(){return t},set:function(n){t=n}})?[]:(r.Add(e,n=[n,[]]),[n])},e)})),u=M.Get(t);try{for(;u.MoveNext();)!function(){var n=u.Current(),e=null,t=[r.TryGetValue(o(n),{get:function(){return e},set:function(n){e=n}}),e];t[0]&&t[1][1].push(n)}()}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}return S.ofSeq(G.delay(function(){return G.collect(function(n){var e=n[0];return G.map(function(n){return l(e,n)},n[1])},n)}))})},$.Intersect=function(n,t,r){var u=new _.New(n,r);return G.delay(function(){var e=new _.New$1(r);return G.collect(function(n){return u.Contains(n)&&e.Add(n)?[n]:[]},t)})},$.GroupJoin=function(n,e,i,o,l,c){return G.delay(function(){var r=new F.New$3(c),t=S.ofSeq(G.delay(function(){return G.collect(function(n){var e=i(n),t=null;return r.TryGetValue(e,{get:function(){return t},set:function(n){t=n}})?[]:(r.Add(e,n=[n,[]]),[n])},n)})),u=M.Get(e);try{for(;u.MoveNext();)!function(){var n=u.Current(),e=null,t=[r.TryGetValue(o(n),{get:function(){return e},set:function(n){e=n}}),e];t[0]&&t[1][1].push(n)}()}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}return S.iteri(function(n,e){return S.set(t,n,l(e[0],e[1]))},t),t})},$.GroupBy=function(n,e,t,r,u){return G.map(function(n){return r(n.System_Linq_IGrouping_2$get_Key(),n)},$.GroupBy$1(n,e,t,u))},$.GroupBy$1=function(n,i,o,e){return G.delay(function(){return S.ofSeq(G.delay(function(){var u=new F.New$3(e);return G.collect(function(n){var e=i(n),t=o(n),r=null,n=[u.TryGetValue(e,{get:function(){return r},set:function(n){r=n}}),r];return n[0]?(n[1].push(t),[]):((n=[]).push(t),u.set_Item(e,n),[new y.New(e,n)])},n)}))})},$.Except=function(n,e,t){var r=new _.New(n,t),u=M.Get(e);try{for(;u.MoveNext();)r.Remove(u.Current())}finally{"object"==typeof u&&"Dispose"in u&&u.Dispose()}return r},$.Distinct=function(n,t){return G.delay(function(){return G.enumUsing(M.Get(n),function(n){var e=new _.New$1(t);return G.enumWhile(function(){return n.MoveNext()},G.delay(function(){return e.Add(n.Current())?[n.Current()]:[]}))})})},$.DefaultIfEmpty=function(n,e){return G.isEmpty(n)?[e]:n},$.Average=function(n){var e,t=[],r=M.Get(n);try{for(;r.MoveNext();)null!=r.Current()&&t.push((e=r.Current(),b.get(e)));return 0===S.length(t)?null:G.sum(t)/S.length(t)}finally{"object"==typeof r&&"Dispose"in r&&r.Dispose()}},(E=e.Query=B.Class({},o,E)).averageByNullable=function(n,e){n=S.ofSeq(G.choose(function(n){return O.ofNullable(e(n))},n));return 0===S.length(n)?null:S.average(n)},E.sumByNullable=function(n,e){return S.sum(S.ofSeq(G.choose(function(n){return O.ofNullable(e(n))},n)))},E.CheckThenBySource=function(n){return"object"==typeof n&&"System_Linq_IOrderedEnumerable_1$CreateOrderedEnumerable"in n?n:T.FailWith("'thenBy' and 'thenByDescending' may only be used with an ordered input")},E.New=B.Ctor(function(){o.New.call(this)},E)}();