(function() {
    "use strict";
    var a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z, _0, _1, _2;
    a = self;
    b = a.WebSharper = a.WebSharper || {};
    c = b.Forms = b.Forms || {};
    d = c.Bootstrap = c.Bootstrap || {};
    e = d.Controls = d.Controls || {};
    f = e.Simple = e.Simple || {};
    g = a.StartupCode$Tahoe_Web$BootstrapForms = a.StartupCode$Tahoe_Web$BootstrapForms || {};
    h = a.Tahoe = a.Tahoe || {};
    i = h.Web = h.Web || {};
    j = i.IPv4 = i.IPv4 || {};
    k = j.CIDR = j.CIDR || {};
    l = i.Strings = i.Strings || {};
    m = i.WireguardCrypto = i.WireguardCrypto || {};
    n = a.StartupCode$Tahoe_Web$Crypto = a.StartupCode$Tahoe_Web$Crypto || {};
    o = i.Wireguard = i.Wireguard || {};
    p = o.Interface = o.Interface || {};
    q = o.Peer = o.Peer || {};
    r = o.Config = o.Config || {};
    s = i.Validation = i.Validation || {};
    t = i.FormHelpers = i.FormHelpers || {};
    u = a.StartupCode$Tahoe_Web$FormHelpers = a.StartupCode$Tahoe_Web$FormHelpers || {};
    v = i.Shared = i.Shared || {};
    w = i.ConfigGeneratorPage = i.ConfigGeneratorPage || {};
    x = w.FormResult = w.FormResult || {};
    y = i.QrCodeGeneratorPage = i.QrCodeGeneratorPage || {};
    z = a.StartupCode$Tahoe_Web$QrCodeGeneratorPage = a.StartupCode$Tahoe_Web$QrCodeGeneratorPage || {};
    A = b && b.List;
    B = c && c.Doc;
    C = b && b.UI;
    D = C && C.Doc;
    E = b && b.Seq;
    F = a.IntelliFactory;
    G = F && F.Runtime;
    H = c && c.View;
    I = C && C.View;
    J = a.System;
    K = J && J.Guid;
    L = C && C.AttrModule;
    M = C && C.AttrProxy;
    N = b && b.Operators;
    O = b && b.Arrays;
    P = b && b.Utils;
    Q = b && b.Option;
    R = c && c.Form;
    S = c && c.Validation;
    T = b && b.Numeric;
    U = b && b.Concurrency;
    V = b && b.Remoting;
    W = V && V.AjaxRemotingProvider;
    X = C && C.Var$1;
    Y = c && c.Pervasives;
    Z = b && b.Unchecked;
    _0 = b && b.JavaScript;
    _1 = _0 && _0.Promise;
    _2 = a.Math;
    f.ShowErrors = function(_3) {
        return e.ShowErrors([], _3);
    };
    f.Button = function(_3, _4) {
        return ((function(_5) {
            return (e.Button())(_5);
        }(_3))(A.ofArray([(e.cls())("button btn-primary")])))(_4);
    };
    f.Checkbox = function(_3, _4) {
        return e.Checkbox(_3, A.T.Empty, _4, [], []);
    };
    f.TextAreaWithError = function(_3, _4, _5) {
        var _6;
        return (((_6 = e.TextAreaWithError(_3), function(_7) {
            var _8;
            _8 = _6(_7);
            return function(_9) {
                return _8([_9[0], _9[1], _9[2]]);
            };
        })(A.T.Empty))([_4, A.T.Empty, A.T.Empty]))(_5);
    };
    f.TextArea = function(_3, _4) {
        return e.TextArea(_3, A.T.Empty, _4, [], A.T.Empty);
    };
    f.InputPasswordWithError = function(_3, _4, _5) {
        var _6;
        return (((_6 = e.InputPasswordWithError(_3), function(_7) {
            var _8;
            _8 = _6(_7);
            return function(_9) {
                return _8([_9[0], _9[1], _9[2]]);
            };
        })(A.T.Empty))([_4, A.T.Empty, A.T.Empty]))(_5);
    };
    f.InputPassword = function(_3, _4) {
        return e.InputPassword(_3, A.T.Empty, _4, [], A.T.Empty);
    };
    f.InputWithError = function(_3, _4, _5) {
        var _6;
        return (((_6 = e.InputWithError(_3), function(_7) {
            var _8;
            _8 = _6(_7);
            return function(_9) {
                return _8([_9[0], _9[1], _9[2]]);
            };
        })(A.T.Empty))([_4, A.T.Empty, A.T.Empty]))(_5);
    };
    f.Input = function(_3, _4) {
        return e.Input(_3, A.T.Empty, _4, [], A.T.Empty);
    };
    e.ShowErrors = function(_3, _4) {
        return B.ShowErrors(_4, function(_5) {
            return _5.$ == 0 ? D.get_Empty() : D.Element("div", _3, [D.Element("div", A.ofArray([(e.cls())("alert alert-danger")]), E.map(function(_6) {
                return D.Element("p", [], [D.TextNode(_6.message)]);
            }, _5))]);
        });
    };
    e.Button = function() {
        g.$cctor();
        return g.Button;
    };
    e.TextAreaWithError = G.Curried3(function(_3, _4, _5) {
        var _6, _7, _8;
        _6 = _5[0];
        _7 = _5[1];
        _8 = _5[2];
        return function(_9) {
            return e.__InputWithError(D.InputArea, _3, _4, _6, _7, _8, _9);
        };
    });
    e.InputPasswordWithError = G.Curried3(function(_3, _4, _5) {
        var _6, _7, _8;
        _6 = _5[0];
        _7 = _5[1];
        _8 = _5[2];
        return function(_9) {
            return e.__InputWithError(D.PasswordBox, _3, _4, _6, _7, _8, _9);
        };
    });
    e.InputWithError = G.Curried3(function(_3, _4, _5) {
        var _6, _7, _8;
        _6 = _5[0];
        _7 = _5[1];
        _8 = _5[2];
        return function(_9) {
            return e.__InputWithError(D.Input, _3, _4, _6, _7, _8, _9);
        };
    });
    e.__InputWithError = function(_3, _4, _5, _6, _7, _8, _9) {
        var _, $, ba, bb, bc, bd, be, bf, bg;
        _ = H.Through$1(_9, _6);
        $ = I.Map(function(bh) {
            return bh.$ == 1 ? bh.$0.$ != 0 : true;
        }, _);
        ba = I.Map(function(bh) {
            return bh.$ == 1 && bh.$0.$ == 1;
        }, _);
        bb = I.Map(function(bh) {
            var bi;
            return (bh.$ == 1 ? bh.$0.$ == 0 || (bi = bh.$0, false) : true) ? null : {
                $: 1,
                $0: A.reduce(function(bj, bk) {
                    return bj + "; " + bk;
                }, A.map(function(bj) {
                    return bj.message;
                }, bi))
            };
        }, _);
        bc = (bd = K.NewGuid(), a.String(bd));
        be = I.Map2(function(bh, bi) {
            return bh && !bi;
        }, $, ba);
        bf = I.Map2(function(bh, bi) {
            return bh && bi;
        }, $, ba);
        bg = A.ofArray([L.DynamicClassPred("is-valid", be), L.DynamicClassPred("is-invalid", bf)]);
        return D.Element("div", A.ofSeq(E.delay(function() {
            return E.append([(e.cls())("form-group")], E.delay(function() {
                return _5;
            }));
        })), A.ofSeq(E.delay(function() {
            return E.append([D.Element("label", new A.T({
                $: 1,
                $0: M.Create("for", bc),
                $1: _7
            }), [D.TextNode(_4)])], E.delay(function() {
                return E.append([_3(A.append(new A.T({
                    $: 1,
                    $0: (e.cls())("form-control"),
                    $1: new A.T({
                        $: 1,
                        $0: M.Create("id", bc),
                        $1: _8
                    })
                }), bg), _6)], E.delay(function() {
                    return [D.BindView(function(bh) {
                        return bh != null && bh.$ == 1 ? D.Element("div", [(e.cls())("invalid-feedback")], [D.TextNode(bh.$0)]) : D.get_Empty();
                    }, bb)];
                }));
            }));
        })));
    };
    e.Radio = function(_3, _4, _5, _6, _7) {
        return D.Element("div", new A.T({
            $: 1,
            $0: (e.cls())("radio"),
            $1: _4
        }), [D.Element("label", _6, [D.Radio(_7, true, _5), D.TextNode(_3)])]);
    };
    e.Checkbox = function(_3, _4, _5, _6, _7) {
        return D.Element("div", new A.T({
            $: 1,
            $0: (e.cls())("checkbox"),
            $1: _4
        }), [D.Element("label", _6, [D.CheckBox(_7, _5), D.TextNode(_3)])]);
    };
    e.TextArea = function(_3, _4, _5, _6, _7) {
        return D.Element("div", new A.T({
            $: 1,
            $0: (e.cls())("form-group"),
            $1: _4
        }), [D.Element("label", _6, [D.TextNode(_3)]), D.InputArea(new A.T({
            $: 1,
            $0: (e.cls())("form-control"),
            $1: _7
        }), _5)]);
    };
    e.InputPassword = function(_3, _4, _5, _6, _7) {
        return D.Element("div", new A.T({
            $: 1,
            $0: (e.cls())("form-group"),
            $1: _4
        }), [D.Element("label", _6, [D.TextNode(_3)]), D.PasswordBox(new A.T({
            $: 1,
            $0: (e.cls())("form-control"),
            $1: _7
        }), _5)]);
    };
    e.Input = function(_3, _4, _5, _6, _7) {
        return D.Element("div", new A.T({
            $: 1,
            $0: (e.cls())("form-group"),
            $1: _4
        }), [D.Element("label", _6, [D.TextNode(_3)]), D.Input(new A.T({
            $: 1,
            $0: (e.cls())("form-control"),
            $1: _7
        }), _5)]);
    };
    e.Class = function() {
        g.$cctor();
        return g.Class;
    };
    e.cls = function() {
        g.$cctor();
        return g.cls;
    };
    g.$cctor = function() {
        g.$cctor = a.ignore;
        g.cls = L.Class;
        g.Class = L.Class;
        g.Button = G.Curried3(D.Button);
    };
    k = j.CIDR = G.Class({
        toString: function() {
            var _3;
            _3 = this.Address;
            return ((((((G.Curried(function(_4, _5, _6, _7, _8, _9) {
                return _4(a.String(_5) + "." + a.String(_6) + "." + a.String(_7) + "." + a.String(_8) + "/" + a.String(_9));
            }, 6))(a.id))(_3[0]))(_3[1]))(_3[2]))(_3[3]))(this.BitmaskLength);
        }
    }, null, k);
    k.New = function(_3, _4) {
        return new k({
            Address: _3,
            BitmaskLength: _4
        });
    };
    j.generateIpsFromCidr = function(_3) {
        var _4, _5, _6, _7, _8, _9, _, $, ba;
        _4 = _3.Address[3];
        _5 = _3.Address[2];
        _6 = _3.BitmaskLength;
        _7 = _3.Address[1];
        _8 = _3.Address[0];
        !j.isValidCidr(k.New([_8, _7, _5, _4], _6)) ? N.FailWith("Invalid CIDR") : void 0;
        _9 = j.toAddress(_8, _7, _5, _4);
        _ = 4294967295 << 32 - _6;
        $ = _9 & _;
        ba = $ | ~_;
        return E.delay(function() {
            return E.map(a.id, N.range($, ba));
        });
    };
    j.isValidCidr = function(_3) {
        var _4, _5;
        _4 = _3.BitmaskLength;
        return _4 < 0 || _4 > 32 ? false : (_5 = j.toAddress(_3.Address[0], _3.Address[1], _3.Address[2], _3.Address[3]), (_5 & 4294967295 << 32 - _4) === _5);
    };
    j.toBytes = function(_3) {
        return [(_3 & 4278190080) >> 24 & 255, (_3 & 16711680) >> 16 & 255, (_3 & 65280) >> 8 & 255, _3 & 255 & 255];
    };
    j.toAddress = function(_3, _4, _5, _6) {
        return ((N.toUInt(_3) << 8 | N.toUInt(_4)) << 8 | N.toUInt(_5)) << 8 | N.toUInt(_6);
    };
    l.join = function(_3, _4) {
        return O.ofSeq(_4).join(_3);
    };
    m.genPsk = function(_3) {
        return m.getRandomSeededBytes(256 / 8 >> 0, _3);
    };
    m.generateKeyPair = function(_3) {
        return a.axlsign.generateKeyPair(m.getRandomSeededBytes(32, _3));
    };
    m.getRandomSeededBytes = function(_3, _4) {
        var _5;

        function _6() {
            return _4.int32();
        }
        _5 = new a.Uint8Array(_3);
        E.iteri(function(_7, _8) {
            _5[_7] = _8;
        }, E.take(_3, E.map(function(_7) {
            return _7 & 255;
        }, E.collect(function(_7) {
            return E.delay(function() {
                return E.append([(_7 & -16777216) >> 24], E.delay(function() {
                    return E.append([(_7 & 16711680) >> 16], E.delay(function() {
                        return E.append([(_7 & 65280) >> 8], E.delay(function() {
                            return [(_7 & 255) >> 0];
                        }));
                    }));
                }));
            });
        }, E.initInfinite(function() {
            return _6();
        })))));
        return _5;
    };
    m.getRandomBytesFromBrowserCrypto = function(_3) {
        var _4;
        _4 = new a.Uint8Array(_3);
        m.crypto().getRandomValues(_4);
        return _4;
    };
    m.base64Decode = function() {
        n.$cctor();
        return n.base64Decode;
    };
    m.base64Encode = function() {
        n.$cctor();
        return n.base64Encode;
    };
    m.base64 = function() {
        n.$cctor();
        return n.base64;
    };
    m.crypto = function() {
        n.$cctor();
        return n.crypto;
    };
    n.$cctor = function() {
        n.$cctor = a.ignore;
        n.crypto = a.crypto;
        n.base64 = a.base64;
        n.base64Encode = function(_3) {
            return m.base64().bytesToBase64(_3);
        };
        n.base64Decode = function(_3) {
            return m.base64().base64ToBytes(_3);
        };
    };
    p.New = function(_3, _4, _5, _6, _7, _8, _9) {
        return {
            Address: _3,
            PrivateKey: _4,
            PublicKey: _5,
            ListenPort: _6,
            DNS: _7,
            PostUp: _8,
            PostDown: _9
        };
    };
    q.New = function(_3, _4, _5, _6) {
        return {
            PublicKey: _3,
            PreSharedKey: _4,
            AllowedIPs: _5,
            Endpoint: _6
        };
    };
    r.New = function(_3, _4, _5, _6) {
        return {
            FriendlyName: _3,
            ConfigFileName: _4,
            Interface: _5,
            Peers: _6
        };
    };
    o.toConfigString = function(_3) {
        return l.join("\r\n", E.delay(function() {
            return E.append(["[Interface]"], E.delay(function() {
                return E.append([(function(_4) {
                    return function(_5) {
                        return _4("Address = " + P.toSafe(_5));
                    };
                }(a.id))(a.String(_3.Interface.Address))], E.delay(function() {
                    return E.append([(function(_4) {
                        return function(_5) {
                            return _4("ListenPort = " + a.String(_5));
                        };
                    }(a.id))(_3.Interface.ListenPort)], E.delay(function() {
                        return E.append([(function(_4) {
                            return function(_5) {
                                return _4("PrivateKey = " + P.toSafe(_5));
                            };
                        }(a.id))((m.base64Encode())(_3.Interface.PrivateKey))], E.delay(function() {
                            return E.append(E.map(function(_4) {
                                return (function(_5) {
                                    return function(_6) {
                                        return _5("PostUp = " + P.toSafe(_6));
                                    };
                                }(a.id))(_4);
                            }, Q.toList(_3.Interface.PostUp)), E.delay(function() {
                                return E.append(E.map(function(_4) {
                                    return (function(_5) {
                                        return function(_6) {
                                            return _5("PostDown = " + P.toSafe(_6));
                                        };
                                    }(a.id))(_4);
                                }, Q.toList(_3.Interface.PostDown)), E.delay(function() {
                                    function _4(_5, _6, _7, _8) {
                                        return (function(_9) {
                                            return function(_) {
                                                return _9("DNS = " + P.toSafe(_));
                                            };
                                        }(a.id))((((((G.Curried(function(_9, _, $, ba, bb) {
                                            return _9(a.String(_) + "." + a.String($) + "." + a.String(ba) + "." + a.String(bb));
                                        }, 5))(a.id))(_5))(_6))(_7))(_8));
                                    }
                                    return E.append(E.map(function(_5) {
                                        return _4(_5[0], _5[1], _5[2], _5[3]);
                                    }, Q.toList(_3.Interface.DNS)), E.delay(function() {
                                        return E.append([""], E.delay(function() {
                                            return E.collect(function(_5) {
                                                return E.append(["[Peer]"], E.delay(function() {
                                                    return E.append([(function(_6) {
                                                        return function(_7) {
                                                            return _6("PublicKey = " + P.toSafe(_7));
                                                        };
                                                    }(a.id))((m.base64Encode())(_5.PublicKey))], E.delay(function() {
                                                        return E.append(E.map(function(_6) {
                                                            return (function(_7) {
                                                                return function(_8) {
                                                                    return _7("PresharedKey = " + P.toSafe(_8));
                                                                };
                                                            }(a.id))((m.base64Encode())(_6));
                                                        }, Q.toList(_5.PreSharedKey)), E.delay(function() {
                                                            return E.append([(function(_6) {
                                                                return function(_7) {
                                                                    return _6("AllowedIPs = " + P.toSafe(_7));
                                                                };
                                                            }(a.id))(_5.AllowedIPs)], E.delay(function() {
                                                                return E.append(E.map(function(_6) {
                                                                    return (function(_7) {
                                                                        return function(_8) {
                                                                            return _7("Endpoint = " + P.toSafe(_8));
                                                                        };
                                                                    }(a.id))(_6);
                                                                }, Q.toList(_5.Endpoint)), E.delay(function() {
                                                                    return [""];
                                                                }));
                                                            }));
                                                        }));
                                                    }));
                                                }));
                                            }, _3.Peers);
                                        }));
                                    }));
                                }));
                            }));
                        }));
                    }));
                }));
            }));
        }));
    };
    s.validateChoose = function(_3, _4, _5) {
        return R.Map(function(_6) {
            return _6.$0;
        }, S.Is(function(_6) {
            return _6 != null;
        }, _4, R.Map(_3, _5)));
    };
    t.enabledDependentOn = function(_3) {
        return L.DynamicPred("disabled", I.Map(function(_4) {
            return !_4;
        }, _3), I.Const("disabled"));
    };
    t.noneIfEmpty = function(_3) {
        return _3 === "" ? null : {
            $: 1,
            $0: _3
        };
    };
    t.MaskLength = function() {
        u.$cctor();
        return u["|MaskLength|_|"];
    };
    t.UByte = function(_3) {
        var _4;
        _4 = t.NumBetween(0, 255, _3);
        return _4 != null && _4.$ == 1 ? {
            $: 1,
            $0: _4.$0 & 255
        } : null;
    };
    t.NumBetween = function(_3, _4, _5) {
        var _6;
        try {
            _6 = T.ParseInt32(_5);
            return _6 >= _3 && _6 <= _4 ? {
                $: 1,
                $0: _6
            } : null;
        } catch (_7) {
            return null;
        }
    };
    t.integerBetween = function(_3, _4) {
        var _5, _6;

        function _7(_8) {
            return _8 >= _3 && _8 <= _4 ? {
                $: 1,
                $0: _8
            } : null;
        }
        _5 = (_6 = function(_8) {
            return _8 == null ? null : _7(_8.$0);
        }, function(_8) {
            return _6(t.tryMapInt(_8));
        });
        return (G.Curried3(s.validateChoose))(_5);
    };
    t.ParseInt32 = function() {
        u.$cctor();
        return u["|ParseInt32|_|"];
    };
    t.tryMapInt = function(_3) {
        try {
            return _3.length > 0 ? {
                $: 1,
                $0: T.ParseInt32(_3)
            } : null;
        } catch (_4) {
            return null;
        }
    };
    t.Trim = function(_3) {
        return _3.trim();
    };
    t.Split = function(_3, _4) {
        return _4.split(_3);
    };
    u.$cctor = function() {
        u.$cctor = a.ignore;
        u["|ParseInt32|_|"] = t.tryMapInt;
        u["|MaskLength|_|"] = function(_3) {
            return t.NumBetween(0, 32, _3);
        };
    };
    v.Newsletter = function() {
        var _3, _4;

        function _5(_7) {
            var _8;
            U.Start((_8 = null, U.Delay(function() {
                return U.Bind((new W.New()).Async("", [_7]), function() {
                    _3.Set(true);
                    return U.Zero();
                });
            })), null);
        }









// this is the main footer
        function _6(_7, _8) {
            return D.Element("a", [], []);
        }
        _3 = X.Create$1(false);
        _4 = R.Run(function(_7) {
            _5(_7);
        }, R.WithSubmit(Y.op_LessMultiplyGreater(R.Return(a.id), S.IsNotEmpty("", R.Yield("")))));
        var ssks = R.Render(function(_7) {
            return function(_8) {
                return _6(_7, _8);
            };
        }, _4);
        console.log(ssks);
        return ssks;
    };
    
    
    
    
    
    //this is the paypal!!!!!!!
    /*
    v.Donate = function() {
        var sdjjkj = D.Element("form", [], [])
        console.log(sdjjkj)
        return sdjjkj;
    };*/
    v.GenerateQrCode = function(_3, _4, _5) {
        var _6, _7;
        return _3.length < 2000 ? (_6 = a.qrcodegen.QrCode, (_7 = _6.encodeText(_3, _6.Ecc.MEDIUM), D.Element("canvas", [L.Style("min-width", _4), L.Style("max-height", _5), L.Style("max-width", _5), L.Class("pixelated"), L.OnAfterRender(function(_8) {
            _7.drawCanvas(1, 1, _8);
        })], []))) : D.get_Empty();
    };
    x.New = function(_3, _4, _5, _6, _7, _8, _9, _, $, ba) {
        return {
            RandomSeed: _3,
            Port: _4,
            NumClients: _5,
            CIDR: _6,
            Endpoint: _7,
            DNS: _8,
            UsePSK: _9,
            PostUp: _,
            PostDown: $,
            AllowedIPs: ba
        };
    };
    w.Main$120$85 = G.Curried3(function(_3, _4, _5) {
        return U.Start(_3(), null);
    });
    w.Main = function() {
        var _3, _4, _5, _6, _7, _8, _9, _, $, ba, bb, bc, bd, be, bf, bg, bh, bi, bj, bk;

        function bl(bo) {
            var bp, bq;
            bp = 300;
            bq = o.toConfigString(bo);
            X.Create$1(null);
            M.Create("style", (((G.Curried3(function(br, bs, bt) {
                return br("width:" + a.String(bs) + "px; height:" + a.String(bt) + "px");
            }))(a.id))(bp))(bp));
            return D.Element("div", [], [D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-md-12")], [D.Element("h3", [], [D.TextNode(bo.FriendlyName)])])]), D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-md-8")], [D.Element("table", [], [D.Element("tr", [], [D.Element("td", [], [D.TextNode("IP Address")]), D.Element("td", [], [D.Element("code", [], [D.TextNode(a.String(bo.Interface.Address))])])]), D.Element("tr", [], [D.Element("td", [], [D.TextNode("Listen Port")]), D.Element("td", [], [D.Element("code", [], [D.TextNode((function(br) {
                return function(bs) {
                    return br(a.String(bs));
                };
            }(a.id))(bo.Interface.ListenPort))])])]), D.Element("tr", [], [D.Element("td", [], [D.TextNode("Private Key")]), D.Element("td", [], [D.Element("code", [], [D.TextNode((m.base64Encode())(bo.Interface.PrivateKey))])])]), D.Element("tr", [], [D.Element("td", [], [D.TextNode("Public Key")]), D.Element("td", [], [D.Element("code", [], [D.TextNode((m.base64Encode())(bo.Interface.PublicKey))])])])])])]), D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-sm-12 col-md-8")], [D.Element("pre", [L.Class("wireguard-config bg-dark text-white")], [D.TextNode(bq)])]), D.Element("div", [L.Class("col-sm-12 col-md-4")], [v.GenerateQrCode(bq, "15em", "20em")])])]);
        }

        function bm(bo) {
            var bp, bq, br, bs, bt, bu;
            return (bq = t.Split(".", bo), !Z.Equals(bq, null) && bq.length === 4 && (br = t.UByte(O.get(bq, 0)), br != null && br.$ == 1 && (bs = t.UByte(O.get(bq, 1)), bs != null && bs.$ == 1 && (bt = t.UByte(O.get(bq, 2)), bt != null && bt.$ == 1 && (bu = t.UByte(O.get(bq, 3)), bu != null && bu.$ == 1 && (bp = [br.$0, bs.$0, bt.$0, bu.$0], true)))))) ? {
                $: 1,
                $0: [bp[0], bp[1], bp[2], bp[3]]
            } : null;
        }

        function bn(bo, bp, bq, br, bs, bt, bu, bv, bw, bx) {
            var by, bz, bA, bB, bC, bD, bE, bF, bG;
            return D.Element("div", [], [D.Element("div", [L.Class("row")], [(((by = e.InputWithError("Random Seed"), function(bH) {
                var bI;
                bI = by(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-12")])))([bo, A.T.Empty, A.T.Empty]))(bx.view)]), D.Element("div", [L.Class("row")], [(((bz = e.InputWithError("Listen Port"), function(bH) {
                var bI;
                bI = bz(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([bp, A.T.Empty, A.T.Empty]))(bx.view), (((bA = e.InputWithError("Number of Clients"), function(bH) {
                var bI;
                bI = bA(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([_9, A.T.Empty, A.T.Empty]))(bx.view), (((bB = e.InputWithError("CIDR"), function(bH) {
                var bI;
                bI = bB(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([_, A.T.Empty, A.T.Empty]))(bx.view)]), D.Element("div", [L.Class("row")], [(((bC = e.InputWithError("Client Allowed IPs"), function(bH) {
                var bI;
                bI = bC(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([bw, A.T.Empty, A.T.Empty]))(bx.view), (((bD = e.InputWithError("Endpoint (Optional)"), function(bH) {
                var bI;
                bI = bD(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([br, A.T.Empty, A.T.Empty]))(bx.view), (((bE = e.InputWithError("DNS (Optional)"), function(bH) {
                var bI;
                bI = bE(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-sm-12 col-md-4")])))([bs, A.T.Empty, A.T.Empty]))(bx.view)]), D.Element("div", [L.Class("row")], [(((bF = e.InputWithError("Post-Up rule"), function(bH) {
                var bI;
                bI = bF(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-12")])))([bu, A.T.Empty, A.T.Empty]))(bx.view), (((bG = e.InputWithError("Post-Down rule"), function(bH) {
                var bI;
                bI = bG(bH);
                return function(bJ) {
                    return bI([bJ[0], bJ[1], bJ[2]]);
                };
            })(A.ofArray([L.Class("col-12")])))([bv, A.T.Empty, A.T.Empty]))(bx.view), e.Checkbox("Use Pre-Shared Keys (Enhanced Security)", A.ofArray([L.Class("col-12")]), bt, [], [])]), D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-4")], [((function(bH) {
                return (e.Button())(bH);
            }("Generate Config"))(A.ofArray([L.Class("btn btn-primary")])))(function() {
                bx.Trigger();
            })])])]);
        }
        _3 = X.Create$1([]);
        _4 = I.Map(function(bo) {
            var bp;

            function bq() {
                var br, bs, bt;
                br = new a.JSZip();
                bs = br.folder("configs");
                E.iter(function(bu) {
                    bs.file(bu.ConfigFileName, (function(bv) {
                        return function(bw) {
                            return bv("# Generated by WireguardConfig.com\n" + P.toSafe(bw));
                        };
                    }(a.id))(o.toConfigString(bu)));
                }, bo);
                bt = null;
                return U.Delay(function() {
                    return U.Bind(_1.AsAsync(br.generateAsync({
                        type: "blob"
                    })), function(bu) {
                        a.saveAs(bu, "wireguard_configs.zip");
                        return U.Zero();
                    });
                });
            }
            bp = E.map(bl, bo);
            return O.length(bo) > 0 ? D.Element("div", [], A.ofSeq(E.delay(function() {
                return E.append([D.Element("hr", [], [])], E.delay(function() {
                    return E.append([D.Element("h2", [], [D.TextNode("...and voila, here are your configs!")])], E.delay(function() {
                        return E.append([D.Element("div", [], A.ofSeq(E.delay(function() {
                            return [D.Element("button", A.ofArray([L.Class("download"), M.HandlerImpl("click", function() {
                                return function() {
                                    return U.Start(bq(), null);
                                };
                            })]), A.ofArray([D.Element("span", [], [D.TextNode("Download")]), D.Element("span", [], [D.TextNode("ZIP")])]))];
                        })))], E.delay(function() {
                            return bp;
                        }));
                    }));
                }));
            }))) : D.get_Empty();
        }, _3.get_View());
        _5 = (_6 = m.getRandomBytesFromBrowserCrypto(2048 / 8 >> 0), (m.base64Encode())(_6));
        _7 = 0;
        _8 = 65535;
        _9 = X.Create$1("3");
        _ = X.Create$1("10.0.0.0/24");
        $ = (ba = 1, (bb = 2000, (bc = (bd = R.YieldVar(_9), ((t.integerBetween(ba, bb))((((G.Curried3(function(bo, bp, bq) {
            return bo("Must be between " + a.String(bp) + " and " + a.String(bq));
        }))(a.id))(ba))(bb)))(bd)), (be = s.validateChoose(function(bo) {
            var bp, bq, br, bs;
            return (bq = t.Split("/", t.Trim(bo)), !Z.Equals(bq, null) && bq.length === 2 && (br = bm(O.get(bq, 0)), br != null && br.$ == 1 && (bs = (t.ParseInt32())(O.get(bq, 1)), bs != null && bs.$ == 1 && (j.isValidCidr(k.New([br.$0[0], br.$0[1], br.$0[2], br.$0[3]], bs.$0)) && (bp = [br.$0[0], br.$0[1], bs.$0, br.$0[2], br.$0[3]], true))))) ? {
                $: 1,
                $0: k.New([bp[0], bp[1], bp[3], bp[4]], bp[2])
            } : null;
        }, "Must be a valid CIDR", R.YieldVar(_)), (bf = R.Builder.Do, R.Dependent$1(bc, function(bo) {
            return R.Dependent$1(S.Is(function(bp) {
                function bq(br, bs, bt, bu) {
                    return bu !== 0 && bu !== 255;
                }
                return E.length(E.filter(function(br) {
                    return bq(br[0], br[1], br[2], br[3]);
                }, E.map(j.toBytes, j.generateIpsFromCidr(bp)))) >= bo + 1;
            }, "Not enough available IPs in given CIDR", be), function(bp) {
                return R.Return([bo, bp]);
            });
        }))))));
        bg = (bh = X.Create$1((function(bo) {
            return function(bp) {
                return bo("iptables -A FORWARD -i %i -j ACCEPT; iptables -t nat -A POSTROUTING -o " + P.toSafe(bp) + " -j MASQUERADE");
            };
        }(a.id))("eth0")), (bi = X.Create$1((function(bo) {
            return function(bp) {
                return bo("iptables -D FORWARD -i %i -j ACCEPT; iptables -t nat -D POSTROUTING -o " + P.toSafe(bp) + " -j MASQUERADE");
            };
        }(a.id))("eth0")), Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(R.Return(function(bo) {
            return function(bp) {
                return [bo, bp];
            };
        }), R.Map(t.noneIfEmpty, R.YieldVar(bh))), R.Map(t.noneIfEmpty, R.YieldVar(bi)))));
        bj = R.Render(G.Curried(bn, 10), R.Run(function(bo) {
            var bp, bq, br, bs, bt, bu, bv, bw, bx, by;

            function bz(bB, bC, bD, bE) {
                return bE !== 0 && bE !== 255;
            }

            function bA(bB, bC) {
                return [bB, bC, bo.UsePSK ? {
                    $: 1,
                    $0: m.genPsk(bq)
                } : null];
            }
            bp = E.take(bo.NumClients + 1, E.filter(function(bB) {
                return bz(bB[0], bB[1], bB[2], bB[3]);
            }, E.map(j.toBytes, j.generateIpsFromCidr(bo.CIDR))));
            bq = new _2.seedrandom(bo.RandomSeed);
            br = E.cache(E.map(function(bB) {
                return [bB, m.generateKeyPair(bq)];
            }, bp));
            bs = E.head(br);
            bt = bs[1];
            bu = E.cache(E.map(function(bB) {
                return bA(bB[0], bB[1]);
            }, E.skip(1, br)));
            bv = r.New("Server", "server.conf", p.New(k.New(bs[0], bo.CIDR.BitmaskLength), bt["private"], bt["public"], bo.Port, null, bo.PostUp, bo.PostDown), O.ofSeq(E.delay(function() {
                return E.collect(function(bB) {
                    return [q.New(bB[1]["public"], bB[2], (((((G.Curried(function(bC, bD, bE, bF, bG) {
                        return bC(a.String(bD) + "." + a.String(bE) + "." + a.String(bF) + "." + a.String(bG) + "/32");
                    }, 5))(a.id))(bB[0][0]))(bB[0][1]))(bB[0][2]))(bB[0][3]), null)];
                }, bu);
            })));
            bw = (bx = (by = bo.DNS, by == null ? null : bm(by.$0)), E.mapi(function(bB, bC) {
                var bD;
                bD = bC[1];
                return r.New((function(bE) {
                    return function(bF) {
                        return bE("Client " + a.String(bF));
                    };
                }(a.id))(bB + 1), (function(bE) {
                    return function(bF) {
                        return bE("client_" + P.padNumLeft(a.String(bF), 5) + ".conf");
                    };
                }(a.id))(bB + 1), p.New(k.New(bC[0], bo.CIDR.BitmaskLength), bD["private"], bD["public"], bo.Port, bx, null, null), [q.New(bt["public"], bC[2], bo.AllowedIPs, bo.Endpoint)]);
            }, bu));
            _3.Set(O.ofSeq(E.delay(function() {
                return E.append([bv], E.delay(function() {
                    return bw;
                }));
            })));
        }, R.WithSubmit(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(Y.op_LessMultiplyGreater(R.Return(G.Curried3(function(bo, bp, bq) {
            var br, bs;
            br = bq[0];
            bs = bq[1];
            return G.Curried(function(bt, bu, bv, bw) {
                var bx, by;
                bx = bw[0];
                by = bw[1];
                return function(bz) {
                    return x.New(bo, bp, br, bs, bt, bu, bv, bx, by, bz);
                };
            }, 4);
        })), S.IsNotEmpty("The random seed should be non-empty.", R.Yield(_5))), (bk = R.Yield("51820"), ((t.integerBetween(_7, _8))((((G.Curried3(function(bo, bp, bq) {
            return bo("Must be between " + a.String(bp) + " and " + a.String(bq));
        }))(a.id))(_7))(_8)))(bk))), $), R.Map(t.noneIfEmpty, R.Yield("myserver.dyndns.org:51820"))), R.Map(t.noneIfEmpty, R.Yield(""))), R.Yield(false)), bg), S.IsNotEmpty("Allowed IPs cannot be empty", R.Yield("0.0.0.0/0, ::/0"))))));
        return D.Element("div", [], [D.Element("h2", [], [D.TextNode("Wireguard Config Generator")]), D.Element("div", [], [D.Element("p", [], [D.TextNode("This tool is to assist with creating config files for a WireGuard 'road-warrior' setup whereby you have a server and a bunch of clients. Simply enter the parameters for your particular setup and click Generate Config to get started.")]), D.Element("p", [L.Class("alert alert-info")], [D.TextNode("All keys, QR codes and config files are generated client-side by your browser and are never seen by our server.")])]), bj, D.Element("br", [], []), v.Newsletter(), D.EmbedView(_4)]);
    };
    y.Main = function() {
        return D.Element("div", [], [D.Element("h2", [], [D.TextNode("QR Code Generator")]), D.Element("div", [], [D.Element("p", [], [D.TextNode("This tool allows you to easily convert a wireguard config file into a QR code")]), D.Element("p", [L.Class("alert alert-info")], [D.TextNode("QR codes are generated client-side by your browser and are never seen by our server.")])]), y.f(), D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-sm-12 col-md-4")], [D.EmbedView(y.qrMarkup())])]), D.Element("br", [], []), v.Newsletter()]);
    };
    y.f = function() {
        z.$cctor();
        return z.f;
    };
    y.qrMarkup = function() {
        z.$cctor();
        return z.qrMarkup;
    };
    y.configForm = function() {
        z.$cctor();
        return z.configForm;
    };
    y.config = function() {
        z.$cctor();
        return z.config;
    };
    y.sampleConfig = function() {
        z.$cctor();
        return z.sampleConfig;
    };
    z.$cctor = function() {
        z.$cctor = a.ignore;

        function _3(_4, _5) {
            var _6;
            return D.Element("div", [], [D.Element("div", [L.Class("row")], [(((_6 = e.TextAreaWithError("Paste the contents of your config file below and click generate"), function(_7) {
                var _8;
                _8 = _6(_7);
                return function(_9) {
                    return _8([_9[0], _9[1], _9[2]]);
                };
            })(A.ofArray([L.Class("col-12")])))([_4, A.T.Empty, A.ofArray([L.Class("multiline")])]))(_5.view)]), D.Element("div", [L.Class("row")], [D.Element("div", [L.Class("col-4")], [((function(_7) {
                return (e.Button())(_7);
            }("Generate QR Code"))(A.ofArray([L.Class("btn btn-primary")])))(function() {
                _5.Trigger();
            })])])]);
        }
        z.sampleConfig = "# THIS IS A SAMPLE - PASTE YOUR REAL CONFIG HERE!\n[Interface]\nAddress = 10.0.0.1/24\nListenPort = 51820\nPrivateKey = AKfKfwytjTVuWUfnFHcMJ3OZW2MgLavsnPaR/X/AEW4=\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n[Peer]\nPublicKey = XDxcjkIzlGjbtbPwlpR/ZcLB2uv7e+DojytSeAA6f14=\nAllowedIPs = 10.0.0.2/32\n\n[Peer]\nPublicKey = aCTaVGra0OCe8ZAUeqTrfTXdR3NaR91P5JJi/0Hxam8=\nAllowedIPs = 10.0.0.3/32";
        z.config = X.Create$1(null);
        z.configForm = R.Run(function(_4) {
            y.config().Set({
                $: 1,
                $0: _4
            });
        }, R.WithSubmit(Y.op_LessMultiplyGreater(R.Return(a.id), S.Is(function(_4) {
            return _4.length <= 2000;
        }, "Max length is 2000 characters", S.IsNotEmpty("The config file contents need to be pasted here.", R.Yield(y.sampleConfig()))))));
        z.qrMarkup = I.Map(function(_4) {
            return _4 != null && _4.$ == 1 ? v.GenerateQrCode(_4.$0, "30em", "30em") : D.get_Empty();
        }, y.config().get_View());
        z.f = R.Render(function(_4) {
            return function(_5) {
                return _3(_4, _5);
            };
        }, y.configForm());
    };
}());
